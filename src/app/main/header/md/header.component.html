<mat-toolbar>
  <nb-action class="control-item">
    <a (click)="toggleSidebar()" href="#" class="navigation">
      <i class="nb-menu"></i>
    </a>
  </nb-action>

  <img class="logo" src="../../../../assets/atlas-logo.png" alt="logo">


  <ng-container *ngIf="state$ | async as state">
    <ng-container *ngIf="state.isLoggedIn">
      <span class="spacer"></span>
      <ng-container *ngIf="state.country">
        <button mat-button *ngFor="let view of VIEW" (click)="switchView(view)">{{ ('dashboard.' + view) | translate | uppercase }}
        </button>
      </ng-container>

      <ng-container *ngIf="state.notifications.length > 0">
        <td-notification-count [notifications]="state.notifications.length" [matMenuTriggerFor]="notificationsMenu">
          <mat-icon matTooltip="{{ state.notifications.length }} Notifications">notifications </mat-icon>
        </td-notification-count>

        <mat-menu #notificationsMenu="matMenu" [overlapTrigger]="false">
          <td-menu>
            <div td-menu-header class="mat-subhead">Notifications</div>
            <mat-nav-list dense>
              <ng-container *ngFor="let notification of state.notifications; let last=last">
                <a mat-list-item>
                  <mat-icon matListAvatar>today</mat-icon>
                  <h4 matLine>
                    <span class="text-wrap">{{ notification.message }}</span>
                  </h4>
                </a>
                <mat-divider *ngIf="!last"></mat-divider>
              </ng-container>
            </mat-nav-list>
            <button mat-button color="accent" td-menu-footer>
              See All Notifications
            </button>
            <button mat-button color="accent" td-menu-footer (click)="clearNotifications()">
              Delete All Notifications
            </button>
          </td-menu>
        </mat-menu>
      </ng-container>




      <nb-actions size="medium" class="header-container right medium">
        <nb-action class="control-item" icon="nb-email"></nb-action>
        <nb-action class="control-item">
          <!-- <nb-search type="rotate-layout"></nb-search> -->
        </nb-action>
        <nb-action>
          <button mat-button (click)="logOut()">
            {{ 'dashboard.logout' | translate | uppercase }}
          </button>
        </nb-action>
        <nb-action>
          <nb-user [menu]="userMenu" [name]="('dashboard.hello' | translate:{value: state.user.nameDisplay + '!'})" picture="../../../../../assets/steve.jpg"
            (menuClick)="menuClick($event)">
          </nb-user>
        </nb-action>
      </nb-actions>
    </ng-container>
  </ng-container>
</mat-toolbar>
